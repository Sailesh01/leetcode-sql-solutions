SELECT N, CASE WHEN N NOT IN (SELECT P FROM Tree WHERE P IS NOT NULL) THEN 'Leaf' 
WHEN P IS NULL THEN 'Root' ELSE 'Inner' END AS Type
FROM Tree
ORDER BY N